import{p as u,j as e,aj as j,A as h,as as C,u as f,_ as d,at as y,au as b,c as v,al as N,C as A,W as p,n as S,T as k,an as w,ao as M,av as U,aw as G,ax as B,ay as I,az as P,a as T,aA as z,ac as F,aB as R,aC as E}from"./index-15ec7641.js";const O=u(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"}),"Block"),_=u(e.jsx("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"CheckCircleOutline"),$=({page:r=1,pageSize:a=10,search:n=""})=>j({queryKey:["users",r,a,n],queryFn:async()=>(await h.get(`/user/all?page=${r}&limit=${a}&search=${n}`)).data,retry:(t,l)=>t<1,refetchOnWindowFocus:!1,staleTime:1/0,enabled:r>0&&a>0}),q=()=>{const r=C();return f({mutationFn:async a=>{const{data:n}=await h.patch(`/user/${a}`);return n},onSuccess:a=>{r.invalidateQueries("users"),d.success(a==null?void 0:a.message)},onError:a=>{var n,t;d.error(((t=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:t.message)||"An error occurred")}})};function D(){var c;const{searchValue:r}=y(),a=b(),n=v(),[t,l]=N.useState({page:1,pageSize:10}),{mutate:x}=q(),{data:o,isPending:m,isSuccess:L}=$({page:t.page,pageSize:t.pageSize,search:r[a]}),g=[{field:"avatar",headerName:"Avatar",renderCell:s=>e.jsx(F,{src:s.value,alt:"Avatar"}),width:50},{field:"ifastId",headerName:"User ID",width:150},{field:"fullName",valueGetter:(s,i)=>(i==null?void 0:i.firstName)+" "+(i==null?void 0:i.lastName),headerName:"Full Name",width:150},{field:"email",headerName:"Email",width:200},{field:"phoneNo",headerName:"Phone No",width:150},{field:"role",headerName:"Role",renderCell:s=>e.jsx(R,{size:"small",label:s.value})},{field:"actions",type:"actions",headerName:"Actions",getActions:s=>[e.jsx(E,{icon:s.row.status?e.jsx(O,{}):e.jsx(_,{}),label:s.row.status?"Block":"Unblock",onClick:()=>x(s.row._id)})],flex:.5}];return e.jsxs(A,{children:[e.jsx(p,{children:e.jsxs("title",{children:["User View | ",(c=S)==null?void 0:c.appName]})}),e.jsx(k,{variant:"h4",sx:{mb:2},children:"Users"}),e.jsx(w,{elevation:3,sx:{height:"calc(100vh - 200px)",width:"100%"},children:e.jsx(M,{columns:g,rows:o==null?void 0:o.data,loading:m,pageSizeOptions:[5,10,20,50,100],paginationMode:"server",getRowId:s=>s._id,rowCount:(o==null?void 0:o.totalCount)||0,paginationModel:{page:t.page-1,pageSize:t.pageSize},onPaginationModelChange:({page:s,pageSize:i})=>l({page:s+1,pageSize:i}),slots:{toolbar:()=>e.jsxs(U,{sx:{py:2},children:[e.jsx(G,{}),e.jsx(B,{}),e.jsx(I,{}),e.jsx(P,{}),e.jsx(T,{sx:{padding:.5},startIcon:e.jsx(z,{}),onClick:()=>n.push("/user/create"),children:"Add"})]})},slotProps:{toolbar:{sx:{display:"flex",justifyContent:"space-between",p:2}},columnHeaders:{sx:{color:"primary.main"}}}})})]})}function V(){return e.jsxs(e.Fragment,{children:[e.jsx(p,{children:e.jsx("title",{children:" User | IfastAcademy "})}),e.jsx(D,{})]})}export{V as default};

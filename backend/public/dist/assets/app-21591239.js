import{a0 as i,t as W,ai as J,aj as y,A as g,ak as q,al as $,j as e,c as G,C,T as v,ab as l,am as o,B as H,an as K,ao as P,ae as z,ap as L,aq as Q,ar as V,W as U}from"./index-ecd95760.js";i.array,i.string,i.string;i.bool,i.func,i.object;i.string,i.string,i.array.isRequired;i.shape({image:i.string,title:i.string,description:i.string,postedAt:i.instanceOf(Date)});i.array,i.string,i.string;i.object,i.bool;i.object,i.string,i.string;i.string,i.string,i.array.isRequired;const S=400,M=72;W(J)(({theme:t})=>({height:S,"& .apexcharts-canvas, .apexcharts-inner, svg, foreignObject":{height:"100% !important"},"& .apexcharts-legend":{height:M,borderTop:`dashed 1px ${t.palette.divider}`,top:`calc(${S-M}px) !important`}}));i.object,i.string,i.string;i.object,i.string,i.string;const X=()=>y({queryKey:["students-count"],queryFn:async()=>{const{data:t}=await g.get("/student/all/count");return t},staleTime:1/0,retry:(t,s)=>t<1}),Y=X;function Z(){return y({queryKey:["employees-count"],queryFn:async()=>{const{data:t}=await g.get("/master/employee/all/count");return t},retry:(t,s)=>t<1,staleTime:1/0})}const w=()=>y({queryKey:["users-today-birthday-count"],queryFn:async()=>(await g.get("/user/get-today-birthdays-count")).data,retry:(t,s)=>t<1,refetchOnWindowFocus:!1,staleTime:1/0}),ee=w,te=({roles:t=[],children:s})=>{const{data:c}=q()||{},d=c==null?void 0:c.data,[u,h]=$.useState(!1);return $.useEffect(()=>{const x=t.includes(d==null?void 0:d.role);h(!x)},[d,t]),u?null:e.jsx(e.Fragment,{children:s})},se=te,ae=()=>y({queryKey:["todayFollowup"],queryFn:async()=>{const{data:t}=await g.get("/dashboard/today-followup");return t},staleTime:1/0,retry:(t,s)=>s.status===404?!1:t<2}),R=ae,ne=()=>y({queryKey:["todayAdmission"],queryFn:async()=>{const{data:t}=await g.get("/dashboard/today-admission");return t},staleTime:1/0,retry:(t,s)=>s.status===404?!1:t<2}),k=ne,ie=()=>y({queryKey:["totalDropoutStudent"],queryFn:async()=>{const{data:t}=await g.get("/dashboard/total-dropout-student");return t},staleTime:1/0,retry:(t,s)=>s.status===404?!1:t<2}),E=ie,le=()=>y({queryKey:["totalCollectedFeeInThisMonth"],queryFn:async()=>{const{data:t}=await g.get("/dashboard/total-collected-fees-by-range");return t},staleTime:1/0,retry:(t,s)=>s.status===404?!1:t<2}),B=le,ce=()=>y({queryKey:["todayCollectedFee"],queryFn:async()=>{const{data:t}=await g.get("/dashboard/today-collected-fees");return t},staleTime:1/0,retry:(t,s)=>s.status===404?!1:t<2}),O=ce;function oe(){var T,_,N,F,I;const t=G(),{data:s}=Y(),{data:c}=Z(),{data:d}=ee(),u=(T=R())==null?void 0:T.data,h=(_=k())==null?void 0:_.data,x=(N=E())==null?void 0:N.data,j=(F=B())==null?void 0:F.data,p=(I=O())==null?void 0:I.data,b=[{field:"fullName",headerName:"Full name",description:"This column has a value getter and is not sortable.",sortable:!1,width:160,valueGetter:(m,n)=>{var r,a;return`${((r=n==null?void 0:n.leadDetails)==null?void 0:r.firstName)||""} ${((a=n==null?void 0:n.leadDetails)==null?void 0:a.lastName)||""}`}},{field:"Phone number",valueGetter:(m,n)=>{var r;return(r=n==null?void 0:n.leadDetails)==null?void 0:r.phoneNo},headerName:"Phone number",type:"number",width:150},{field:"AssignedTo",headerName:"Assigned To",valueGetter:(m,n)=>{var r,a,f;return`${(r=n==null?void 0:n.assignedTo)==null?void 0:r.firstName} ${(a=n==null?void 0:n.assignedTo)==null?void 0:a.lastName}- ${(f=n==null?void 0:n.assignedTo)==null?void 0:f.ifastId}`}},{field:"Notes",headerName:"Notes",width:200,valueGetter:(m,n)=>n==null?void 0:n.notes},{field:"dueDate",headerName:"Due Date",width:150,valueGetter:(m,n)=>z(n==null?void 0:n.dueDate)},{field:"FollowupDetails",headerName:"Followup Details",width:200,valueGetter:(m,n)=>n==null?void 0:n.followupDetails},{field:"status",headerName:"Status",width:150,valueGetter:(m,n)=>n==null?void 0:n.status}];return e.jsxs(C,{maxWidth:"xl",children:[e.jsx(v,{variant:"h4",sx:{mb:5},children:"Hi, Welcome back ðŸ‘‹"}),e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(se,{roles:["admin","superadmin","employee"],children:e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Total Collected Fee In This Month",total:j==null?void 0:j.total,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/ic_money_bag.svg"})})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Today Collected Fee",total:p==null?void 0:p.total,color:"error",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/ic_money_bag.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Student",onClick:()=>t.push("/student/all"),total:(s==null?void 0:s.count)||0,color:"info",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_student.svg",style:{width:"60px",height:"60px"}})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Dropout Student",total:x==null?void 0:x.count,color:"info",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/ic_user-minus.svg",style:{width:"60px",height:"60px"}})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Staff",total:(c==null?void 0:c.count)||0,onClick:()=>t.push("/employee/all"),color:"info",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_teacher.svg",style:{width:"60px",height:"60px"}})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Today Followup",total:u==null?void 0:u.count,color:"warning",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_folllowups.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Today Admission",total:h==null?void 0:h.count,color:"warning",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_user_check.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Happy Birthday",total:d==null?void 0:d.count,color:"warning",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_happybirthday.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Resource Issue",total:5,color:"warning",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_laptop.svg"})})})]}),e.jsxs(H,{component:K,sx:{py:3,px:2,mt:3,maxHeight:400,width:"100%"},children:[e.jsx(v,{variant:"h6",sx:{my:2},children:"Today Followups"}),e.jsx(P,{rows:(u==null?void 0:u.data)||[],getRowId:m=>m==null?void 0:m._id,columns:b,initialState:{pagination:{paginationModel:{pageSize:5}}},disableRowSelectionOnClick:!0})]})]})}const re=({id:t="",role:s=""})=>y({queryKey:["totalAdmissionInThisMonth",t,s],queryFn:async()=>{const{data:c}=await g.get("/dashboard/total-admission-in-this-month?role="+s+"&id="+t);return c},staleTime:1/0,retry:(c,d)=>d.status===404?!1:c<2}),de=()=>y({queryKey:["myIncome"],queryFn:async()=>{const{data:t}=await g.get("/dashboard/my-income");return t},staleTime:1/0,retry:(t,s)=>s.status===404?!1:t<2});function ue(){var T,_,N,F,I,m,n;const t=[{field:"fullName",headerName:"Full name",description:"This column has a value getter and is not sortable.",sortable:!1,width:160,valueGetter:(r,a)=>{var f,D;return`${((f=a==null?void 0:a.leadDetails)==null?void 0:f.firstName)||""} ${((D=a==null?void 0:a.leadDetails)==null?void 0:D.lastName)||""}`}},{field:"Phone number",valueGetter:(r,a)=>{var f;return(f=a==null?void 0:a.leadDetails)==null?void 0:f.phoneNo},headerName:"Phone number",type:"number",width:150},{field:"AssignedTo",headerName:"Assigned To",valueGetter:(r,a)=>{var f,D,A;return`${(f=a==null?void 0:a.assignedTo)==null?void 0:f.firstName} ${(D=a==null?void 0:a.assignedTo)==null?void 0:D.lastName}- ${(A=a==null?void 0:a.assignedTo)==null?void 0:A.ifastId}`}},{field:"Notes",headerName:"Notes",width:200,valueGetter:(r,a)=>a==null?void 0:a.notes},{field:"dueDate",headerName:"Due Date",width:150,valueGetter:(r,a)=>fDate(a==null?void 0:a.dueDate)},{field:"FollowupDetails",headerName:"Followup Details",width:200,valueGetter:(r,a)=>a==null?void 0:a.followupDetails},{field:"status",headerName:"Status",width:150,valueGetter:(r,a)=>a==null?void 0:a.status}];G();const s=(_=(T=q())==null?void 0:T.data)==null?void 0:_.data,c=(N=re({id:s==null?void 0:s._id,role:s==null?void 0:s.role}))==null?void 0:N.data,d=(F=k({id:s==null?void 0:s._id,role:s==null?void 0:s.role}))==null?void 0:F.data,u=L().data,h=E().data,x=R().data,j=(I=B())==null?void 0:I.data,p=(m=O())==null?void 0:m.data,b=(n=de())==null?void 0:n.data;return e.jsxs(C,{children:[e.jsxs(v,{variant:"h4",sx:{mb:5},children:["Hi, Welcome ",s==null?void 0:s.firstName]}),e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Total Collected Fees In Month",total:j==null?void 0:j.total,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/ic_money_bag.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Today Collected Fees",total:p==null?void 0:p.total,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/ic_money_bag.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"My Expenses",total:0,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/ic_hand_money.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"My Income",total:b==null?void 0:b.data,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_fee.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"My Batch",total:u==null?void 0:u.count,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/ic_batch.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Dropout Students",total:h==null?void 0:h.count,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_student.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Joined Students In Month",total:c==null?void 0:c.count,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_student.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Joined Students In Today",total:d==null?void 0:d.count,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_student.svg"})})})]}),e.jsxs(H,{component:K,sx:{mt:3,py:3,px:2,maxHeight:400,width:"100%"},children:[e.jsx(v,{variant:"h6",sx:{mb:2},children:"Todays Followups"}),e.jsx(P,{rows:(x==null?void 0:x.data)||[],columns:t,getRowId:r=>r==null?void 0:r._id})]})]})}const me=({studentId:t})=>y({queryKey:["student-total-paid",t],queryFn:async()=>{const{data:s}=await g.get("/student/get-total-paid-fee/"+t);return s},staleTime:1/0,retry:(s,c)=>s<1}),he=({studentId:t})=>y({queryKey:["student-curr-attendances",t],queryFn:async()=>{const{data:s}=await g.get("/student/get-batches-attendance/"+t);return s},staleTime:1/0,retry:(s,c)=>s<1});function xe(){var u,h,x,j,p;const t=G(),s=(h=(u=q())==null?void 0:u.data)==null?void 0:h.data,c=(x=Q({studentId:s==null?void 0:s._id}).data)==null?void 0:x.count,d=(j=me({studentId:s==null?void 0:s._id}).data)==null?void 0:j.totalPaid;return(p=he({studentId:s==null?void 0:s._id}).data)==null||p.data,e.jsxs(C,{children:[e.jsxs(v,{variant:"h4",sx:{mb:5},children:["Hi, Welcome ",s==null?void 0:s.firstName]}),e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Paid Fees",total:d,color:"success",onClick:()=>t.push("/student/fees"),icon:e.jsx("img",{alt:"icon",src:"/assets/icons/ic_hand_money.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"Absent Days",total:8,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/navbar/ic_calendar.svg"})})}),e.jsx(l,{xs:12,sm:6,md:4,children:e.jsx(o,{title:"My Batch",total:c,onClick:()=>t.push("/student/batch"),color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/ic_batch.svg"})})})]}),e.jsx(v,{variant:"h5",sx:{mt:2,mb:3},children:"My Attendance"}),e.jsx(V,{})]})}function ye(){var s,c;const t=(c=(s=q())==null?void 0:s.data)==null?void 0:c.data;return(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"?e.jsx(oe,{}):(t==null?void 0:t.role)==="employee"?e.jsx(ue,{}):(t==null?void 0:t.role)==="student"?e.jsx(xe,{}):null}function fe(){return e.jsxs(e.Fragment,{children:[e.jsx(U,{children:e.jsx("title",{children:" Dashboard | IfastAcademy "})}),e.jsx(ye,{})]})}export{fe as default};
